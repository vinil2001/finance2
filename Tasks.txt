FileViewer:
- Реалтзовать возможность удаления (и может добавления новых???) файлов непосредственно из представления.

Ошибки на странице редактирования:
- Убрать ajax-обновление галочек с checkbox-ов - изменять вместе со всем платежом в контроле в методе Edit
- Если на частичной оплате была установлена галочка "Оплачен", то после её снятия
не появляется иконка удаления это оплаты.

PaymentSatatemnts Create:
- Добавить проверку на наличие файла. Если пользователь сохраняет форму без добавления файла, спросить желает ли он сохранить без файла.
	Если пользователь забыл приложить файл то вернуть его в представление Create (сохранить на форме все ранее веденные данные).
	Делать проверку непосредственно на представлении.
- При попытке добавления платежа, в случае если указать только компанию, возникает ошибка связанная с CurrencyId.	
- PaymentStatement Index:
3. Проверить логику снятия галочек InvoiceChecked, PaymentApproved - при снятии галочек начиная с PaymentDone не происходит обновление статуса младшей по статусу галочки.
5. Если PaymentDone == false и если при этом В оплату > 0, сделать этот чекбокс красным цветом или выделить его другим способом.
6. Добавить в конце все старые (не вошедние в последнее 100 шт.), неоплаченные счета.

- Отправка смс при оплате счета

5. Проверить работоспособность загрузки счета (перед загрузкой есть смысл удалять старый).
6. При загрузке представления Edite не срабатывает пересчет % (функция SumChange) - done 
7. InvoiceSumm в формате 0.00 в котроллере PaymentStatement.Create не проходит валидацию.
	ErrorMessage = "The value '0.00' is not valid for InvoiceSumma."
	При изменении суммы на десятичное число (без запятой) ошибка не появляется, валидацию поле проходит.
8. Summ в формате 0.00 не проходит валидацию.
Exception = {"The parameter conversion from type 'System.String' to type 'System.Decimal' failed. See the inner exception for more information."}
Если применить replace(".", ",") к InvoiceSumm и Summ, то фалидацию в контроллере проходим.
Но при этом не считаются проценты. Для рассчета процентов надо сделать обратный replace(",", ".").

9. Если нет суммы в частичной оплате платеж не может быть отмечен как оплаченный (Summ[i] = null ? PaymentDone = false : PaymentDone = true).

https://stackoverflow.com/questions/11822480/error-with-decimal-in-mvc3-the-value-is-not-valid-for-field


MySql.Data.MySqlClient.MySqlException: 'There is already an open DataReader associated with this Connection which must be closed first.'

Note that while a DataReader is open, the Connection is in use exclusively by that DataReader. You cannot execute any commands for the Connection, including creating another DataReader, until the original DataReader is closed.

https://www.lucidchart.com/documents/edit/313818e0-2450-4c37-bfc5-0278150b9413/0

*******************************************************************************************************
- После создания нов.компании в PaymentStatements Create перем. UploadDocumentUrl = null;
Даже если документ был загружен.
При выборе компании из базы существующих в UploadDocumentUrl попадает адресс картинки (счета). 

- Если пользователь полностью впечтал самостоятельно корректное название компании,
она не получит KltId, так как это происходит только в случае выбора компании из списка.
Нужно в перехваченном событии Submit, проверить в случае отсутствие $('#KltId').val()
наличие компании в базе каким-то ajax-запросом. 

- Если при создании PaymentStatement выбрать правильную компанию, а затем исправить её название на
неправильное - оно будет продолжить считаться корректным, так как остаётся старый KltId (????)
*******************************************************************************************************
- Вместо удаления компаний сделать их перемещение в архив.
Сделать нов.таблицу в бд. Finance где будут храниться id архивных комп.
https://www.google.com.ua/search?client=opera&hs=p3f&ei=lX51W5fiIMHe6QSWsb2IBg&q=исключить+элементы+одного+списка+из+другого+C%23&oq=исключить+элементы+одного+списка+из+другого+C%23&gs_l=psy-ab.3...7324.8909.0.9330.3.3.0.0.0.0.176.421.0j3.3.0..3..0...1.1.64.psy-ab..0.1.136...33i160k1.0.xzHznd2lrMU
- Сделать раздел - управления пользователями!!! (Изменение ролей, логинов, паролей) 

- Поиск по имени компании, номеру счета, дате счета, коментарию;???

- добавить статус - "Состояние сделки". С выбором возможных состояний: 
	-Доставлен и оприходован на склад, 
	-Частичная поставка, 
	-Ожидается поступление на склад поставщика и др.	
Создать справочник "Состояния сделок", с возможностью добавления и редактирования статусов.
В момент добавления статуса к сделке сделать возможность приписывать краткий комментарий, напр:  Частичная поставка: "Не доставили позиции ...., обещают довезти 20.05.18"
Записывать и показывать дату изменения стауса или комментария к нему.

- добавить выбор валюты и справочник валют - тянуть валюту из OrestDb;

- Сделать возможность частичной оплаты счета. Если пользователь отметил что он желает оплачивать счет частями, дать возможность указать сумму к оплате. При этом общая сумма счета должна быть указанна как 
основная. В Index и с SortByPayument отображать основную сумму, и сумму оплаченных частями. При переходе в Edit должен отображаться список оплат с датам и подписями отв.лиц.

//Debug.Log() - использовать !!!
//Global.asax.cs
//Отслеживание входа в аккаунт стартует в homecontroller


- Загрузка файлов с помощью перетаскивания
- Редактирование PaymentStatement Edit -> добавить возможность перезаливки файла, в уже созданный ранее Платеж. Проверить если платеж ранее был подписан, вывести сообщение о том что редктирование запрещено.


- Сделать возможность импорта из OrestDb тех компаний которых нет в базе Finance.
	Для этого интегрировать поиск по компаниям - SearchAutocomplete (CounterpartyController) в Index контрагентов.
	Использовать его для поиска и импорта компаний из базы ОРЕСТ, в базу Finance.-- DONE
	
- На форме создания прихода при добавлении контрагента, банка и т.д. новые значения должны
быть подставлены в соответствующие поля после закрытия модального окна. 

- При удалении контрагента, проверить есть ли по нему операции (Приход или Расход), если есть то сообщить пользователю о том 
  что удаление не возможно из-за того что по данному пользователю ранее выполнялись операции. И предложить перенести
  пользователя в архив;
- Создать справичники: Банки, Контрагенты(Плательщик/Получатель), Форма оплаты, Категория, Статья/Тип
- Импортировать данные из базы orest (делать импорт в онлайн режиме каждый раз при обращении к справочникам):
	Банки, Контрагенты(Плательщик/Получатель), Форма оплаты, Категория, Статья/Тип 
	Данные подключения к БД orest:
	 base = orest
 	 host = 185.67.3.212
 	 user = admin_usr
 	 psw = iHJN0uT9
     port = 3306
	http://185.67.3.212:2030
    Root пароль: RlW9nfsUdGp2

- Импорт "Банка прихода", Банка расхода и Кассы прихода:

Таблица ksh - касса приход
Таблица bkh - банка приход

Таблица bkh - банк приход с значением в tp = 1
IncomingData -> datd
BankId -> bank (найти таблицу с банками)
CounterpartyId - klt (связать с таблицой клиентов)
IncomingSum - sd
IncomingCategoryId - отсутствует
InvoiceNumber - nsht
InvoiceData - ? дата есть в номере счёта, возможно в связи с другой таблицей
WayOfPaymentId - банк-приход

finance@orest.ua - Finance1
anton@orest.ua - Anton2018


SELECT  bkh.id AS BankIncomingId, bkh.ndoc AS DocumentNumbeInOrestDb, bkh.curs AS CurrencyRate, NULL AS PaymentSum, bkh.sd AS TotalPaymentSumm, bkh.ncht AS InvoiceNumber, bkh.datd AS DocumentCreated, bkh.dusr AS DucumentEdited, 
                   bkh.klt AS PayerId, bkh.comt AS Comment, klt.name AS NameKlt, bank.name AS NameBank, '0' AS type
FROM      bkh INNER JOIN
                   klt ON bkh.klt = klt.id INNER JOIN
                   bank ON bkh.bank = bank.id
UNION
SELECT  ksh.id AS KassaIncomingId, ksh.ndoc AS DocumentNumbeInOrestDb, ksh.curs AS CurrencyRate, ksh.sm AS PaymentSum, ksh.sd AS TotalPaymentSumm, ksh.ncht AS InvoiceNumber, ksh.datd AS DocumentCreated, ksh.dusr AS DucumentEdited, 
                   ksh.klt AS PayerId, ksh.comt AS Comment, klt_1.name AS NameKlt, NULL AS NameBank, '1' AS type
FROM      ksh INNER JOIN
                   klt klt_1 ON ksh.klt = klt_1.id

finance@orest.ua - Finance1
anton@orest.ua - Anton2018
boss@orest.ua - Leonid1955
user@user.ua - User123

Счет формируется из таблиц rsh, tp, rsp

Код из Edita
                    //// получаем имя файла
                    //string fileName = Guid.NewGuid().ToString() + System.IO.Path.GetFileName(UploadDocumentUrl.FileName);
                    //// сохраняем файл в папку Files в проекте
                    //UploadDocumentUrl.SaveAs(Server.MapPath("~/Files/" + fileName));
                    //paymentStatement.DocumentUrl = "/Files/" + fileName;